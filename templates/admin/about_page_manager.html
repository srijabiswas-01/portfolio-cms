{% extends 'admin/base.html' %}
{% load static %}

{% block title %}About Page Manager - Admin Panel{% endblock %}
{% block page_title %}About Page Content{% endblock %}

{% block content %}
<div style="max-width: 1400px;">
    
    <!-- Main Content Form -->
    <form method="POST" id="aboutPageForm">
        {% csrf_token %}
        
        <!-- Page Header -->
        <div class="admin-card" style="margin-bottom: 1.5rem;">
            <h2 style="font-size: 1.5rem; font-weight: 600; font-family: 'Poppins', sans-serif; color: var(--admin-text-primary); margin-bottom: 1.5rem;">
                <i class="bi bi-person-fill text-primary mr-2"></i>
                Page Header
            </h2>
            
            <div class="admin-form-group">
                <label class="admin-form-label" for="page_title">Page Title</label>
                <input type="text" 
                       id="page_title" 
                       name="page_title" 
                       class="admin-form-input"
                       value="{{ about_page.page_title }}"
                       placeholder="About Me">
            </div>
        </div>
        
        <!-- Introduction Section -->
        <div class="admin-card" style="margin-bottom: 1.5rem;">
            <h2 style="font-size: 1.5rem; font-weight: 600; font-family: 'Poppins', sans-serif; color: var(--admin-text-primary); margin-bottom: 1.5rem;">
                <i class="bi bi-file-text-fill text-info mr-2"></i>
                Introduction Content
            </h2>
            
            <label class="admin-form-label">Introduction (Rich Text)</label>
            <div id="quill-introduction" style="min-height: 300px;">
                {{ about_page.introduction|safe }}
            </div>
            <input type="hidden" id="introduction" name="introduction">
        </div>
        
        <div class="admin-card" style="margin-bottom: 1.5rem;">
            <h2 style="font-size: 1.5rem; font-weight: 600; font-family: 'Poppins', sans-serif; color: var(--admin-text-primary); margin-bottom: 1.5rem;">
                <i class="bi bi-eye-fill text-warning mr-2"></i>
                Visibility Controls
            </h2>
            <div class="grid grid-cols-3 gap-4">
                <div class="admin-form-group">
                    <label class="admin-form-label">Show Page Title</label>
                    <input type="checkbox"
                           name="show_page_title"
                           {% if about_page.show_page_title %}checked{% endif %}
                           style="width: 1.25rem; height: 1.25rem; cursor: pointer;">
                </div>
                <div class="admin-form-group">
                    <label class="admin-form-label">Show Introduction</label>
                    <input type="checkbox"
                           name="show_introduction"
                           {% if about_page.show_introduction %}checked{% endif %}
                           style="width: 1.25rem; height: 1.25rem; cursor: pointer;">
                </div>
                <div class="admin-form-group">
                    <label class="admin-form-label">Show Stats Section</label>
                    <input type="checkbox"
                           name="show_stats_section"
                           {% if about_page.show_stats_section %}checked{% endif %}
                           style="width: 1.25rem; height: 1.25rem; cursor: pointer;">
                </div>
            </div>
        </div>

        <!-- Education Section Settings -->
        <div class="admin-card" style="margin-bottom: 1.5rem;">
            <h2 style="font-size: 1.5rem; font-weight: 600; font-family: 'Poppins', sans-serif; color: var(--admin-text-primary); margin-bottom: 1.5rem;">
                <i class="bi bi-mortarboard-fill text-warning mr-2"></i>
                Education Section
            </h2>
            
            <div style="display: flex; align-items: center; margin-bottom: 1rem;">
                <input type="checkbox" 
                       id="show_education" 
                       name="show_education" 
                       {% if about_page.show_education %}checked{% endif %}
                       style="width: 1.25rem; height: 1.25rem; margin-right: 0.75rem; cursor: pointer;">
                <label for="show_education" style="color: var(--admin-text-primary); cursor: pointer;">
                    Show Education Section
                </label>
            </div>
        </div>
        
        <!-- Interests Section Settings -->
        <div class="admin-card" style="margin-bottom: 1.5rem;">
            <h2 style="font-size: 1.5rem; font-weight: 600; font-family: 'Poppins', sans-serif; color: var(--admin-text-primary); margin-bottom: 1.5rem;">
                <i class="bi bi-lightbulb-fill text-success mr-2"></i>
                Interests Section
            </h2>
            
            <div class="grid grid-cols-2 gap-4">
                <div class="admin-form-group">
                    <label class="admin-form-label" for="interests_title">Section Title</label>
                    <input type="text" 
                           id="interests_title" 
                           name="interests_title" 
                           class="admin-form-input"
                           value="{{ about_page.interests_title }}">
                </div>
                
                <div class="admin-form-group">
                    <label class="admin-form-label" for="interests_subtitle">Section Subtitle</label>
                    <input type="text" 
                           id="interests_subtitle" 
                           name="interests_subtitle" 
                           class="admin-form-input"
                           value="{{ about_page.interests_subtitle }}">
                </div>
            </div>
            <div class="admin-form-group">
                <label class="admin-form-label">Show Interests Section</label>
                <input type="checkbox"
                       name="show_interests"
                       {% if about_page.show_interests %}checked{% endif %}
                       style="width: 1.25rem; height: 1.25rem; cursor: pointer;">
            </div>
        </div>

        <!-- Values Section Settings -->
        <div class="admin-card" style="margin-bottom: 1.5rem;">
            <h2 style="font-size: 1.5rem; font-weight: 600; font-family: 'Poppins', sans-serif; color: var(--admin-text-primary); margin-bottom: 1.5rem;">
                <i class="bi bi-heart-fill text-danger mr-2"></i>
                Core Values Section
            </h2>
            
            <div class="grid grid-cols-2 gap-4">
                <div class="admin-form-group">
                    <label class="admin-form-label" for="values_title">Section Title</label>
                    <input type="text" 
                           id="values_title" 
                           name="values_title" 
                           class="admin-form-input"
                           value="{{ about_page.values_title }}">
                </div>
                
                <div class="admin-form-group">
                    <label class="admin-form-label" for="values_subtitle">Section Subtitle</label>
                    <input type="text" 
                           id="values_subtitle" 
                           name="values_subtitle" 
                           class="admin-form-input"
                           value="{{ about_page.values_subtitle }}">
                </div>
            </div>
            <div class="admin-form-group">
                <label class="admin-form-label">Show Values Section</label>
                <input type="checkbox"
                       name="show_values"
                       {% if about_page.show_values %}checked{% endif %}
                       style="width: 1.25rem; height: 1.25rem; cursor: pointer;">
            </div>
        </div>

        <!-- Experiences & Achievements Section -->
        <div class="admin-card" style="margin-bottom: 1.5rem;">
            <h2 style="font-size: 1.5rem; font-weight: 600; font-family: 'Poppins', sans-serif; color: var(--admin-text-primary); margin-bottom: 1.5rem;">
                <i class="bi bi-briefcase-fill text-primary mr-2"></i>
                Experiences &amp; Achievements
            </h2>

            <div class="grid grid-cols-2 gap-4">
                <div class="admin-form-group">
                    <label class="admin-form-label" for="experiences_title">Experiences Title</label>
                    <input type="text"
                           id="experiences_title"
                           name="experiences_title"
                           class="admin-form-input"
                           value="{{ about_page.experiences_title }}">
                </div>
                <div class="admin-form-group">
                    <label class="admin-form-label" for="achievements_title">Achievements Title</label>
                    <input type="text"
                           id="achievements_title"
                           name="achievements_title"
                           class="admin-form-input"
                           value="{{ about_page.achievements_title }}">
                </div>
            </div>

            <div class="grid grid-cols-2 gap-4">
                <div class="admin-form-group">
                    <label class="admin-form-label" for="experiences_description">Experiences Description</label>
                    <textarea id="experiences_description"
                              name="experiences_description"
                              class="admin-form-textarea"
                              rows="4">{{ about_page.experiences_description }}</textarea>
                </div>
                <div class="admin-form-group">
                    <label class="admin-form-label" for="achievements_description">Achievements Description</label>
                    <textarea id="achievements_description"
                              name="achievements_description"
                              class="admin-form-textarea"
                              rows="4">{{ about_page.achievements_description }}</textarea>
                </div>
            </div>

            <div class="grid grid-cols-2 gap-4">
                <div class="admin-form-group">
                    <label class="admin-form-label">Show Experiences Card</label>
                    <input type="checkbox"
                           name="show_experiences_section"
                           {% if about_page.show_experiences_section %}checked{% endif %}
                           style="width: 1.25rem; height: 1.25rem; cursor: pointer;">
                </div>
                <div class="admin-form-group">
                    <label class="admin-form-label">Show Achievements Card</label>
                    <input type="checkbox"
                           name="show_achievements_section"
                           {% if about_page.show_achievements_section %}checked{% endif %}
                           style="width: 1.25rem; height: 1.25rem; cursor: pointer;">
                </div>
            </div>
        </div>

        <!-- Action Buttons -->
        <div style="display: flex; gap: 1rem; justify-content: flex-end; margin-bottom: 2rem;">
            <a href="{% url 'admin_dashboard' %}" class="admin-btn-secondary">
                Cancel
            </a>
            <button type="submit" class="admin-btn-success">
                <i class="bi bi-check-lg mr-2"></i>
                Save Page Content
            </button>
        </div>
    </form>

    <!-- Manage Experiences Entries -->
    <div class="admin-card" style="margin-bottom: 1.5rem;">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
            <h2 style="font-size: 1.5rem; font-weight: 600; font-family: 'Poppins', sans-serif; color: var(--admin-text-primary);">
                <i class="bi bi-briefcase mr-2"></i>
                Experiences Entries
            </h2>
            <button onclick="openExperienceModal('add')" class="admin-btn-primary">
                <i class="bi bi-plus-lg mr-2"></i>
                Add Experience
            </button>
        </div>
        {% if experiences_list %}
        <div class="admin-table">
            <table>
                <thead>
                    <tr>
                        <th>Order</th>
                        <th>Title</th>
                        <th>Organization</th>
                        <th>Period</th>
                        <th>Status</th>
                        <th style="text-align: right;">Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for exp in experiences_list %}
                    <tr>
                        <td>{{ exp.order }}</td>
                        <td>
                            <strong>{{ exp.title }}</strong>
                            {% if exp.description %}
                            <p style="font-size:0.75rem; color:var(--admin-text-muted); margin:0;">{{ exp.description|truncatewords:20 }}</p>
                            {% endif %}
                        </td>
                        <td>{{ exp.organization }}</td>
                        <td>{{ exp.period }}</td>
                        <td>
                            <span class="admin-badge {% if exp.is_active %}admin-badge-success{% else %}admin-badge-warning{% endif %}">
                                {% if exp.is_active %}Active{% else %}Inactive{% endif %}
                            </span>
                        </td>
                        <td>
                            <div style="display:flex; justify-content:flex-end; gap:0.25rem;">
                                <form method="post" action="{% url 'admin_experience_toggle_active' exp.id_str %}" style="display:inline;">
                                    {% csrf_token %}
                                    <button type="submit" class="admin-btn-secondary" style="padding:0.35rem 0.85rem;">
                                        {% if exp.is_active %}Deactivate{% else %}Activate{% endif %}
                                    </button>
                                </form>
                                <button type="button" class="admin-btn-secondary" onclick="editExperience('{{ exp.id_str }}', '{{ exp.title|escapejs }}', '{{ exp.organization|escapejs }}', '{{ exp.period|escapejs }}', '{{ exp.description|escapejs }}', {{ exp.order }}, {{ exp.is_active|yesno:'true,false' }})">
                                    <i class="bi bi-pencil"></i>
                                </button>
                                <button type="button" class="admin-btn-danger" onclick="deleteExperience('{{ exp.id_str }}', '{{ exp.title|escapejs }}')">
                                    <i class="bi bi-trash"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}
        <p class="text-secondary">No experience entries yet.</p>
        {% endif %}
    </div>

    <!-- Manage Achievements Entries -->
    <div class="admin-card" style="margin-bottom: 1.5rem;">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
            <h2 style="font-size: 1.5rem; font-weight: 600; font-family: 'Poppins', sans-serif; color: var(--admin-text-primary);">
                <i class="bi bi-award mr-2"></i>
                Achievements Entries
            </h2>
            <button onclick="openAchievementModal('add')" class="admin-btn-primary">
                <i class="bi bi-plus-lg mr-2"></i>
                Add Achievement
            </button>
        </div>
        {% if achievements_list %}
        <div class="admin-table">
            <table>
                <thead>
                    <tr>
                        <th>Order</th>
                        <th>Title</th>
                        <th>Year</th>
                        <th>Status</th>
                        <th style="text-align: right;">Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for achievement in achievements_list %}
                    <tr>
                        <td>{{ achievement.order }}</td>
                        <td>
                            <strong>{{ achievement.title }}</strong>
                            {% if achievement.description %}
                            <p style="font-size:0.75rem; color:var(--admin-text-muted); margin:0;">{{ achievement.description|truncatewords:20 }}</p>
                            {% endif %}
                        </td>
                        <td>{{ achievement.year }}</td>
                        <td>
                            <span class="admin-badge {% if achievement.is_active %}admin-badge-success{% else %}admin-badge-warning{% endif %}">
                                {% if achievement.is_active %}Active{% else %}Inactive{% endif %}
                            </span>
                        </td>
                        <td>
                            <div style="display:flex; justify-content:flex-end; gap:0.25rem;">
                                <form method="post" action="{% url 'admin_achievement_toggle_active' achievement.id_str %}" style="display:inline;">
                                    {% csrf_token %}
                                    <button type="submit" class="admin-btn-secondary" style="padding:0.35rem 0.85rem;">
                                        {% if achievement.is_active %}Deactivate{% else %}Activate{% endif %}
                                    </button>
                                </form>
                                <button type="button" class="admin-btn-secondary" onclick="editAchievement('{{ achievement.id_str }}', '{{ achievement.title|escapejs }}', '{{ achievement.description|escapejs }}', '{{ achievement.year|escapejs }}', '{{ achievement.link|escapejs }}', {{ achievement.order }}, {{ achievement.is_active|yesno:'true,false' }})">
                                    <i class="bi bi-pencil"></i>
                                </button>
                                <button type="button" class="admin-btn-danger" onclick="deleteAchievement('{{ achievement.id_str }}', '{{ achievement.title|escapejs }}')">
                                    <i class="bi bi-trash"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}
        <p class="text-secondary">No achievement entries yet.</p>
        {% endif %}
    </div>
    
    <!-- Manage Research Content -->
    <div class="admin-card" style="margin-bottom: 1.5rem;">
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:1rem;">
            <h2 style="font-size:1.5rem; font-weight:600; color:var(--admin-text-primary);">
                <i class="bi bi-journals mr-2"></i>
                Research & Articles
            </h2>
            <div style="display:flex; gap:0.5rem;">
                <button onclick="openResearchCategoryModal('add')" class="admin-btn-secondary" style="padding:0.5rem 0.75rem; font-size:0.85rem;">
                    <i class="bi bi-plus-lg mr-1"></i>
                    Add Category
                </button>
                <button onclick="openResearchEntryModal('add')" class="admin-btn-primary" style="padding:0.5rem 0.75rem; font-size:0.85rem;">
                    <i class="bi bi-plus-lg mr-1"></i>
                    Add Entry
                </button>
            </div>
        </div>
        <div class="admin-card" style="padding:1rem; background:var(--admin-bg-secondary); border:none;">
            <h3 style="font-weight:600; margin-bottom:0.75rem;">Categories</h3>
            {% if research_categories %}
            <div style="display:flex; flex-direction:column; gap:0.5rem;">
                {% for cat in research_categories %}
                <div class="admin-card" style="padding:0.75rem 1rem;">
                    <div style="display:flex; justify-content:space-between; align-items:center;">
                        <div>
                            <h4 style="margin:0;">{{ cat.name }}</h4>
                            <p style="margin:0; font-size:0.8rem; color:var(--admin-text-muted);">{{ cat.description }}</p>
                        </div>
                        <span class="admin-badge {% if cat.is_active %}admin-badge-success{% else %}admin-badge-warning{% endif %}">
                            {% if cat.is_active %}Active{% else %}Inactive{% endif %}
                        </span>
                    </div>
                    <div style="display:flex; justify-content:flex-end; gap:0.5rem; margin-top:0.5rem;">
                        <button type="button" class="admin-btn-secondary" onclick="openResearchCategoryModal('edit', '{{ cat.id_str }}', '{{ cat.name|escapejs }}', '{{ cat.description|escapejs }}', {{ cat.order }}, {{ cat.is_active|yesno:'true,false' }})">
                            <i class="bi bi-pencil"></i>
                        </button>
                        <form method="post" action="{% url 'admin_research_category_toggle_active' cat.id_str %}" style="display:inline;">
                            {% csrf_token %}
                            <button type="submit" class="admin-btn-secondary" style="padding:0.35rem 0.85rem;">
                                {% if cat.is_active %}Deactivate{% else %}Activate{% endif %}
                            </button>
                        </form>
                        <button type="button" class="admin-btn-danger" onclick="confirmResearchCategoryDelete('{{ cat.id_str }}', '{{ cat.name|escapejs }}')">
                            <i class="bi bi-trash"></i>
                        </button>
                    </div>
                </div>
                {% endfor %}
            </div>
            {% else %}
            <p class="text-secondary">No research categories yet.</p>
            {% endif %}
        </div>

        <div class="admin-card" style="padding:1rem; background:var(--admin-bg-secondary); border:none;" id="research-entries-section">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:0.75rem;">
                <h3 style="font-weight:600; margin:0;">Entries</h3>
                <div style="display:flex; gap:0.5rem;">
                    <button onclick="openResearchEntryModal('add')" class="admin-btn-primary" style="padding:0.35rem 0.75rem; font-size:0.85rem;">
                        <i class="bi bi-plus-lg"></i>
                        Add Entry
                    </button>
                </div>
            </div>
            <form id="researchFilterForm" method="get" style="display:flex; gap:0.75rem; align-items:flex-end; margin-bottom:1rem; flex-wrap:wrap;">
                <div class="admin-form-group" style="flex:1; min-width:180px;">
                    <label class="admin-form-label" for="research_category">Category</label>
                    <select name="research_category" id="research_category" class="admin-form-select">
                        <option value="">All categories</option>
                        {% for cat in research_categories %}
                        <option value="{{ cat.id_str }}" {% if research_category_filter == cat.id_str %}selected{% endif %}>{{ cat.name }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="admin-form-group" style="flex:1; min-width:180px;">
                    <label class="admin-form-label" for="research_search">Search</label>
                    <input type="text" name="research_search" value="{{ research_search }}" id="research_search" class="admin-form-input" placeholder="Keyword">
                </div>
                <button type="submit" class="admin-btn-secondary" style="align-self:flex-end;">
                    Apply
                </button>
            </form>
            {% if research_entries %}
            <div class="admin-table" style="max-height:320px; overflow:auto;">
                <table>
                    <thead>
                        <tr>
                            <th>Title</th>
                            <th>Category</th>
                            <th>Publication</th>
                            <th>Status</th>
                            <th style="text-align:right;">Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for entry in research_entries %}
                        <tr>
                            <td>
                                <strong>{{ entry.title }}</strong>
                                <p style="font-size:0.75rem; color:var(--admin-text-muted); margin:0;">{{ entry.description|truncatewords:15 }}</p>
                            </td>
                            <td>
                                {% if entry.category %}
                                {{ entry.category.name }}
                                {% else %}
                                Uncategorized
                                {% endif %}
                            </td>
                    <td>{{ entry.publication }}</td>
                    <td>
                        <span class="admin-badge {% if entry.is_active %}admin-badge-success{% else %}admin-badge-warning{% endif %}">
                            {% if entry.is_active %}Active{% else %}Inactive{% endif %}
                        </span>
                    </td>
                    <td>
                        <div style="display:flex; justify-content:flex-end; gap:0.25rem;">
                            <form method="post" action="{% url 'admin_research_entry_toggle_active' entry.id_str %}" style="display:inline;">
                                {% csrf_token %}
                                <button type="submit" class="admin-btn-secondary" style="padding:0.35rem 0.85rem;">
                                    {% if entry.is_active %}Deactivate{% else %}Activate{% endif %}
                                </button>
                            </form>
                            {% with entry.category.id_str|default:'' as entry_cat_id %}
                            <button type="button" class="admin-btn-secondary" onclick="editResearchEntry('{{ entry.id_str }}', '{{ entry.title|escapejs }}', '{{ entry.description|escapejs }}', '{{ entry.publication|escapejs }}', '{{ entry.link|escapejs }}', '{{ entry_cat_id }}')">
                                <i class="bi bi-pencil"></i>
                            </button>
                            {% endwith %}
                            <button type="button" class="admin-btn-danger" onclick="confirmResearchEntryDelete('{{ entry.id_str }}', '{{ entry.title|escapejs }}')">
                                <i class="bi bi-trash"></i>
                            </button>
                        </div>
                    </td>
                </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            {% else %}
            <p class="text-secondary">No research entries yet.</p>
            {% endif %}
            {% if research_paginator.num_pages > 1 %}
            <div class="flex justify-between items-center mt-4">
                <div class="text-xs text-muted">
                    Page {{ research_entries.number }} of {{ research_paginator.num_pages }}
                </div>
                <div class="flex gap-2">
                    {% if research_entries.has_previous %}
                    <a href="?research_page={{ research_entries.previous_page_number }}&research_category={{ research_category_filter }}&research_search={{ research_search }}" class="admin-btn-secondary" style="padding:0.35rem 0.85rem;">Prev</a>
                    {% endif %}
                    {% if research_entries.has_next %}
                    <a href="?research_page={{ research_entries.next_page_number }}&research_category={{ research_category_filter }}&research_search={{ research_search }}" class="admin-btn-secondary" style="padding:0.35rem 0.85rem;">Next</a>
                    {% endif %}
                </div>
            </div>
            {% endif %}
        </div>
    </div>

    <!-- Manage Education Entries -->
    <div class="admin-card" style="margin-bottom: 1.5rem;">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
            <h2 style="font-size: 1.5rem; font-weight: 600; font-family: 'Poppins', sans-serif; color: var(--admin-text-primary);">
                <i class="bi bi-mortarboard mr-2"></i>
                Education Entries
            </h2>
            <button onclick="openEducationModal()" class="admin-btn-primary">
                <i class="bi bi-plus-lg mr-2"></i>
                Add Education
            </button>
        </div>
        
        {% if education_list %}
        <div class="admin-table">
            <table>
                <thead>
                    <tr>
                        <th>Order</th>
                        <th>Degree</th>
                        <th>Institution</th>
                        <th>Year</th>
                        <th>Status</th>
                        <th style="text-align: right;">Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for edu in education_list %}
                    <tr>
                        <td>{{ edu.order }}</td>
                        <td>
                            <strong>{{ edu.degree }}</strong>
                            <p style="font-size: 0.75rem; color: var(--admin-text-muted); margin-top: 0.25rem;">{{ edu.description|truncatewords:15 }}</p>
                        </td>
                        <td>{{ edu.institution }}</td>
                        <td>{{ edu.year }}</td>
                        <td>
                            {% if edu.is_active %}
                            <span class="admin-badge admin-badge-success">Active</span>
                            {% else %}
                            <span class="admin-badge admin-badge-warning">Inactive</span>
                            {% endif %}
                        </td>
                        <td>
                            <div style="display: flex; justify-content: flex-end; gap: 0.5rem;">
                                <button onclick="editEducation('{{ edu.id_str }}', '{{ edu.degree|escapejs }}', '{{ edu.institution|escapejs }}', '{{ edu.year }}', '{{ edu.description|escapejs }}', {{ edu.order }})" 
                                        class="admin-btn-secondary" 
                                        style="padding: 0.5rem 0.75rem; font-size: 0.875rem;">
                                    <i class="bi bi-pencil"></i>
                                </button>
                                <form method="post" action="{% url 'admin_education_toggle_active' edu.id_str %}">
                                    {% csrf_token %}
                                    <button type="submit"
                                            class="admin-btn-secondary"
                                            style="padding: 0.35rem 0.75rem; font-size: 0.75rem;">
                                        {% if edu.is_active %}Deactivate{% else %}Activate{% endif %}
                                    </button>
                                </form>
                                <button onclick="deleteEducation('{{ edu.id_str }}', '{{ edu.degree|escapejs }}')" 
                                        class="admin-btn-danger" 
                                        style="padding: 0.5rem 0.75rem; font-size: 0.875rem;">
                                    <i class="bi bi-trash"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}
        <div style="text-align: center; padding: 3rem; color: var(--admin-text-muted);">
            <i class="bi bi-mortarboard" style="font-size: 3rem; margin-bottom: 1rem;"></i>
            <p>No education entries yet. Click "Add Education" to create one.</p>
        </div>
        {% endif %}
    </div>
    
    <!-- Manage Interests -->
    <div class="admin-card" style="margin-bottom: 1.5rem;">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
            <h2 style="font-size: 1.5rem; font-weight: 600; font-family: 'Poppins', sans-serif; color: var(--admin-text-primary);">
                <i class="bi bi-lightbulb mr-2"></i>
                Interests
            </h2>
            <button onclick="openInterestModal()" class="admin-btn-primary">
                <i class="bi bi-plus-lg mr-2"></i>
                Add Interest
            </button>
        </div>
        
        {% if interests_list %}
        <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 1rem;">
            {% for interest in interests_list %}
            <div style="background: var(--admin-bg-secondary); border: 1px solid var(--admin-border-color); border-radius: 0.5rem; padding: 1.5rem; text-align: center; position: relative;">
                <div style="display:flex; justify-content:flex-end; gap:0.5rem; margin-bottom:1rem;">
                    {% if interest.is_active %}
                    <span class="admin-badge admin-badge-success">Active</span>
                    {% else %}
                    <span class="admin-badge admin-badge-warning">Inactive</span>
                    {% endif %}
                </div>
                <i class="bi bi-{{ interest.icon }}" style="font-size: 2.5rem; color: var(--admin-accent-{{ interest.color }}); margin-bottom: 1rem;"></i>
                <h3 style="font-weight: 600; margin-bottom: 0.5rem;">{{ interest.title }}</h3>
                <p style="font-size: 0.875rem; color: var(--admin-text-muted); margin-bottom: 1rem;">{{ interest.description }}</p>
                <div style="display: flex; gap: 0.5rem; justify-content: center;">
                    <button onclick="editInterest('{{ interest.id_str }}', '{{ interest.title|escapejs }}', '{{ interest.description|escapejs }}', '{{ interest.icon }}', '{{ interest.color }}', {{ interest.order }})" 
                            class="admin-btn-secondary" 
                            style="padding: 0.5rem 0.75rem; font-size: 0.875rem;">
                        <i class="bi bi-pencil"></i>
                    </button>
                    <form method="post" action="{% url 'admin_interest_toggle_active' interest.id_str %}" style="display:inline;">
                        {% csrf_token %}
                        <button type="submit" class="admin-btn-secondary" style="padding: 0.35rem 0.75rem; font-size: 0.875rem;">
                            {% if interest.is_active %}Deactivate{% else %}Activate{% endif %}
                        </button>
                    </form>
                    <button onclick="deleteInterest('{{ interest.id_str }}', '{{ interest.title|escapejs }}')" 
                            class="admin-btn-danger" 
                            style="padding: 0.5rem 0.75rem; font-size: 0.875rem;">
                        <i class="bi bi-trash"></i>
                    </button>
                </div>
            </div>
            {% endfor %}
        </div>
        {% else %}
        <div style="text-align: center; padding: 3rem; color: var(--admin-text-muted);">
            <i class="bi bi-lightbulb" style="font-size: 3rem; margin-bottom: 1rem;"></i>
            <p>No interests yet. Click "Add Interest" to create one.</p>
        </div>
        {% endif %}
    </div>
    
    <!-- Manage Core Values -->
    <div class="admin-card">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
            <h2 style="font-size: 1.5rem; font-weight: 600; font-family: 'Poppins', sans-serif; color: var(--admin-text-primary);">
                <i class="bi bi-heart mr-2"></i>
                Core Values
            </h2>
            <button onclick="openValueModal()" class="admin-btn-primary">
                <i class="bi bi-plus-lg mr-2"></i>
                Add Value
            </button>
        </div>
        
        {% if values_list %}
        <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 1rem;">
            {% for value in values_list %}
            <div style="background: var(--admin-bg-secondary); border: 1px solid var(--admin-border-color); border-radius: 0.5rem; padding: 1.5rem; text-align: center; position: relative;">
                <div style="display:flex; justify-content:flex-end; gap:0.5rem; margin-bottom:1rem;">
                    {% if value.is_active %}
                    <span class="admin-badge admin-badge-success">Active</span>
                    {% else %}
                    <span class="admin-badge admin-badge-warning">Inactive</span>
                    {% endif %}
                </div>
                <div style="width: 60px; height: 60px; background: rgba(92, 124, 250, 0.1); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 1rem;">
                    <i class="bi bi-{{ value.icon }}" style="font-size: 1.75rem; color: var(--admin-accent-{{ value.color }});"></i>
                </div>
                <h3 style="font-weight: 600; margin-bottom: 0.5rem;">{{ value.title }}</h3>
                <p style="font-size: 0.875rem; color: var(--admin-text-muted); margin-bottom: 1rem;">{{ value.description|truncatewords:20 }}</p>
                <div style="display: flex; gap: 0.5rem; justify-content: center;">
                    <button onclick="editValue('{{ value.id_str }}', '{{ value.title|escapejs }}', '{{ value.description|escapejs }}', '{{ value.icon }}', '{{ value.color }}', {{ value.order }})" 
                            class="admin-btn-secondary" 
                            style="padding: 0.5rem 0.75rem; font-size: 0.875rem;">
                        <i class="bi bi-pencil"></i>
                    </button>
                    <form method="post" action="{% url 'admin_value_toggle_active' value.id_str %}" style="display:inline;">
                        {% csrf_token %}
                        <button type="submit" class="admin-btn-secondary" style="padding: 0.35rem 0.75rem; font-size: 0.875rem;">
                            {% if value.is_active %}Deactivate{% else %}Activate{% endif %}
                        </button>
                    </form>
                    <button onclick="deleteValue('{{ value.id_str }}', '{{ value.title|escapejs }}')" 
                            class="admin-btn-danger" 
                            style="padding: 0.5rem 0.75rem; font-size: 0.875rem;">
                        <i class="bi bi-trash"></i>
                    </button>
                </div>
            </div>
            {% endfor %}

        </div>
        {% else %}
        <div style="text-align: center; padding: 3rem; color: var(--admin-text-muted);">
            <i class="bi bi-heart" style="font-size: 3rem; margin-bottom: 1rem;"></i>
            <p>No core values yet. Click "Add Value" to create one.</p>
        </div>
        {% endif %}
    </div>
</div>

<!-- Education Modal -->
<div id="educationModal" style="display: none; position: fixed; inset: 0; background: rgba(0, 0, 0, 0.8); z-index: 9999; align-items: center; justify-content: center; overflow-y: auto;">
    <div class="admin-card" style="max-width: 600px; margin: 2rem; width: 100%;">
        <h3 id="educationModalTitle" style="font-weight: 600; margin-bottom: 1.5rem; color: var(--admin-text-primary);">
            Add Education Entry
        </h3>
        
        <form id="educationForm" method="POST">
            {% csrf_token %}
            
            <div class="admin-form-group">
                <label class="admin-form-label">Degree</label>
                <input type="text" name="degree" id="edu_degree" class="admin-form-input" required>
            </div>
            
            <div class="admin-form-group">
                <label class="admin-form-label">Institution</label>
                <input type="text" name="institution" id="edu_institution" class="admin-form-input" required>
            </div>
            
            <div class="admin-form-group">
                <label class="admin-form-label">Year</label>
                <input type="text" name="year" id="edu_year" class="admin-form-input" placeholder="2023 - 2025" required>
            </div>
            
            <div class="admin-form-group">
                <label class="admin-form-label">Description</label>
                <textarea name="description" id="edu_description" class="admin-form-textarea" rows="3" required></textarea>
            </div>
            
            <div class="admin-form-group">
                <label class="admin-form-label">Order (for sorting)</label>
                <input type="number" name="order" id="edu_order" class="admin-form-input" value="0">
            </div>
            
            <div style="display: flex; gap: 0.75rem; margin-top: 1.5rem;">
                <button type="button" onclick="closeEducationModal()" class="admin-btn-secondary" style="flex: 1; justify-content: center;">
                    Cancel
                </button>
                <button type="submit" class="admin-btn-success" style="flex: 1; justify-content: center;">
                    <i class="bi bi-check-lg mr-2"></i>
                    Save
                </button>
            </div>
        </form>
    </div>
</div>

<!-- Interest Modal -->
<div id="interestModal" style="display: none; position: fixed; inset: 0; background: rgba(0, 0, 0, 0.8); z-index: 9999; align-items: center; justify-content: center;">
    <div class="admin-card" style="max-width: 500px; margin: 2rem; width: 100%;">
        <h3 id="interestModalTitle" style="font-weight: 600; margin-bottom: 1.5rem; color: var(--admin-text-primary);">
            Add Interest
        </h3>
        
        <form id="interestForm" method="POST">
            {% csrf_token %}
            
            <div class="admin-form-group">
                <label class="admin-form-label">Title</label>
                <input type="text" name="title" id="int_title" class="admin-form-input" required>
            </div>
            
            <div class="admin-form-group">
                <label class="admin-form-label">Description</label>
                <input type="text" name="description" id="int_description" class="admin-form-input" required>
            </div>
            
                <div class="admin-form-group">
                    <label class="admin-form-label">Bootstrap Icon Name</label>
                    <input type="text" name="icon" id="int_icon" class="admin-form-input" placeholder="graph-up" required>
                    <p class="text-sm text-muted mt-1">
                        Find icons at <a href="https://icons.getbootstrap.com" target="_blank" rel="noopener" class="text-accent-primary hover:underline">icons.getbootstrap.com</a>
                    </p>
                </div>
            
            <div class="admin-form-group">
                <label class="admin-form-label">Color</label>
                <select name="color" id="int_color" class="admin-form-select">
                    <option value="primary">Primary (Cyan)</option>
                    <option value="secondary">Secondary (Purple)</option>
                    <option value="success">Success (Green)</option>
                    <option value="warning">Warning (Yellow)</option>
                    <option value="error">Error (Red)</option>
                </select>
            </div>
            
            <div class="admin-form-group">
                <label class="admin-form-label">Order</label>
                <input type="number" name="order" id="int_order" class="admin-form-input" value="0">
            </div>
            
            <div style="display: flex; gap: 0.75rem; margin-top: 1.5rem;">
                <button type="button" onclick="closeInterestModal()" class="admin-btn-secondary" style="flex: 1; justify-content: center;">
                    Cancel
                </button>
                <button type="submit" class="admin-btn-success" style="flex: 1; justify-content: center;">
                    Save
                </button>
            </div>
        </form>
    </div>
</div>

<!-- Value Modal -->
<div id="valueModal" style="display: none; position: fixed; inset: 0; background: rgba(0, 0, 0, 0.8); z-index: 9999; align-items: center; justify-content: center;">
    <div class="admin-card" style="max-width: 500px; margin: 2rem; width: 100%;">
        <h3 id="valueModalTitle" style="font-weight: 600; margin-bottom: 1.5rem; color: var(--admin-text-primary);">
            Add Core Value
        </h3>
        
        <form id="valueForm" method="POST">
            {% csrf_token %}
            
            <div class="admin-form-group">
                <label class="admin-form-label">Title</label>
                <input type="text" name="title" id="val_title" class="admin-form-input" required>
            </div>
            
            <div class="admin-form-group">
                <label class="admin-form-label">Description</label>
                <textarea name="description" id="val_description" class="admin-form-textarea" rows="3" required></textarea>
            </div>
            
                <div class="admin-form-group">
                    <label class="admin-form-label">Bootstrap Icon Name</label>
                    <input type="text" name="icon" id="val_icon" class="admin-form-input" placeholder="trophy" required>
                    <p class="text-sm text-muted mt-1">
                        Find icons at <a href="https://icons.getbootstrap.com" target="_blank" rel="noopener" class="text-accent-primary hover:underline">icons.getbootstrap.com</a>
                    </p>
                </div>
            
            <div class="admin-form-group">
                <label class="admin-form-label">Color</label>
                <select name="color" id="val_color" class="admin-form-select">
                    <option value="primary">Primary (Cyan)</option>
                    <option value="secondary">Secondary (Purple)</option>
                    <option value="success">Success (Green)</option>
                    <option value="warning">Warning (Yellow)</option>
                    <option value="error">Error (Red)</option>
                </select>
            </div>
            
            <div class="admin-form-group">
                <label class="admin-form-label">Order</label>
                <input type="number" name="order" id="val_order" class="admin-form-input" value="0">
            </div>
            
            <div style="display: flex; gap: 0.75rem; margin-top: 1.5rem;">
                <button type="button" onclick="closeValueModal()" class="admin-btn-secondary" style="flex: 1; justify-content: center;">
                    Cancel
                </button>
                <button type="submit" class="admin-btn-success" style="flex: 1; justify-content: center;">
                    Save
                </button>
            </div>
        </form>
</div>
</div>

<!-- Experience Entry Modal -->
<div id="experienceModal" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.8); z-index:9999; align-items:center; justify-content:center;">
    <div class="admin-card" style="max-width:520px; margin:2rem; width:100%;">
        <h3 id="experienceModalTitle" style="font-weight:600; margin-bottom:1.25rem; color:var(--admin-text-primary);">
            Add Experience Entry
        </h3>
        <form id="experienceForm" method="POST">
            {% csrf_token %}
            <input type="hidden" name="experience_id" id="experience_id">

            <div class="admin-form-group">
                <label class="admin-form-label">Title</label>
                <input type="text" name="title" id="exp_title" class="admin-form-input" required>
            </div>

            <div class="admin-form-group">
                <label class="admin-form-label">Organization</label>
                <input type="text" name="organization" id="exp_organization" class="admin-form-input">
            </div>

            <div class="admin-form-group">
                <label class="admin-form-label">Period</label>
                <input type="text" name="period" id="exp_period" class="admin-form-input" placeholder="e.g., 2021 - Present">
            </div>

            <div class="admin-form-group">
                <label class="admin-form-label">Description</label>
                <textarea name="description" id="exp_description" class="admin-form-textarea" rows="3"></textarea>
            </div>

            <div class="admin-form-group">
                <label class="admin-form-label">Order</label>
                <input type="number" name="order" id="exp_order" class="admin-form-input" value="0">
            </div>

            <div class="admin-form-group" style="display:flex; align-items:center; gap:0.5rem;">
                <input type="checkbox" name="is_active" id="exp_active" checked style="width:1.25rem; height:1.25rem; cursor:pointer;">
                <label for="exp_active" style="margin:0; cursor:pointer; color:var(--admin-text-primary);">Active</label>
            </div>

            <div style="display:flex; gap:0.75rem; margin-top:1.5rem;">
                <button type="button" onclick="closeExperienceModal()" class="admin-btn-secondary" style="flex:1; justify-content:center;">Cancel</button>
                <button type="submit" class="admin-btn-success" style="flex:1; justify-content:center;">Save</button>
            </div>
        </form>
    </div>
</div>

<!-- Achievement Entry Modal -->
<div id="achievementModal" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.8); z-index:9999; align-items:center; justify-content:center;">
    <div class="admin-card" style="max-width:520px; margin:2rem; width:100%;">
        <h3 id="achievementModalTitle" style="font-weight:600; margin-bottom:1.25rem; color:var(--admin-text-primary);">
            Add Achievement Entry
        </h3>
        <form id="achievementForm" method="POST">
            {% csrf_token %}
            <input type="hidden" name="achievement_id" id="achievement_id">

            <div class="admin-form-group">
                <label class="admin-form-label">Title</label>
                <input type="text" name="title" id="ach_title" class="admin-form-input" required>
            </div>

            <div class="admin-form-group">
                <label class="admin-form-label">Year</label>
                <input type="text" name="year" id="ach_year" class="admin-form-input" placeholder="e.g., 2023">
            </div>

            <div class="admin-form-group">
                <label class="admin-form-label">Link</label>
                <input type="url" name="link" id="ach_link" class="admin-form-input" placeholder="https://">
            </div>

            <div class="admin-form-group">
                <label class="admin-form-label">Description</label>
                <textarea name="description" id="ach_description" class="admin-form-textarea" rows="3"></textarea>
            </div>

            <div class="admin-form-group">
                <label class="admin-form-label">Order</label>
                <input type="number" name="order" id="ach_order" class="admin-form-input" value="0">
            </div>

            <div class="admin-form-group" style="display:flex; align-items:center; gap:0.5rem;">
                <input type="checkbox" name="is_active" id="ach_active" checked style="width:1.25rem; height:1.25rem; cursor:pointer;">
                <label for="ach_active" style="margin:0; cursor:pointer; color:var(--admin-text-primary);">Active</label>
            </div>

            <div style="display:flex; gap:0.75rem; margin-top:1.5rem;">
                <button type="button" onclick="closeAchievementModal()" class="admin-btn-secondary" style="flex:1; justify-content:center;">Cancel</button>
                <button type="submit" class="admin-btn-success" style="flex:1; justify-content:center;">Save</button>
            </div>
        </form>
    </div>
</div>

<!-- Research Category Modal -->
<div id="researchCategoryModal" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.8); z-index:9999; align-items:center; justify-content:center;">
    <div class="admin-card" style="max-width:520px; margin:2rem; width:100%;">
        <h3 id="researchCategoryModalTitle" style="font-weight:600; margin-bottom:1.25rem; color:var(--admin-text-primary);">
            Add Research Category
        </h3>
        <form id="researchCategoryForm" method="POST">
            {% csrf_token %}
            <input type="hidden" name="category_id" id="research_category_id">
            <div class="admin-form-group">
                <label class="admin-form-label">Name</label>
                <input type="text" name="name" id="research_category_name" class="admin-form-input" required>
            </div>
            <div class="admin-form-group">
                <label class="admin-form-label">Description</label>
                <textarea name="description" id="research_category_description" class="admin-form-textarea" rows="3"></textarea>
            </div>
            <div class="admin-form-group">
                <label class="admin-form-label">Order</label>
                <input type="number" name="order" id="research_category_order" class="admin-form-input" value="0">
            </div>
            <div class="admin-form-group" style="display:flex; align-items:center; gap:0.5rem;">
                <input type="checkbox" name="is_active" id="research_category_active" checked style="width:1.25rem; height:1.25rem; cursor:pointer;">
                <label for="research_category_active" style="margin:0; cursor:pointer; color:var(--admin-text-primary);">Active</label>
            </div>
            <div style="display:flex; gap:0.75rem; margin-top:1.5rem;">
                <button type="button" onclick="closeResearchCategoryModal()" class="admin-btn-secondary" style="flex:1; justify-content:center;">Cancel</button>
                <button type="submit" class="admin-btn-success" style="flex:1; justify-content:center;">Save</button>
            </div>
        </form>
    </div>
</div>

<!-- Research Entry Modal -->
<div id="researchEntryModal" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.8); z-index:9999; align-items:center; justify-content:center;">
    <div class="admin-card" style="max-width:600px; margin:2rem; width:100%;">
        <h3 id="researchEntryModalTitle" style="font-weight:600; margin-bottom:1.25rem; color:var(--admin-text-primary);">
            Add Research Entry
        </h3>
        <form id="researchEntryForm" method="POST">
            {% csrf_token %}
            <input type="hidden" name="entry_id" id="research_entry_id">
            <div class="admin-form-group">
                <label class="admin-form-label">Title</label>
                <input type="text" name="title" id="research_entry_title" class="admin-form-input" required>
            </div>
            <div class="admin-form-group">
                <label class="admin-form-label">Description</label>
                <textarea name="description" id="research_entry_description" class="admin-form-textarea" rows="3"></textarea>
            </div>
            <div class="admin-form-group">
                <label class="admin-form-label">Publication</label>
                <input type="text" name="publication" id="research_entry_publication" class="admin-form-input">
            </div>
            <div class="admin-form-group">
                <label class="admin-form-label">Link</label>
                <input type="url" name="link" id="research_entry_link" class="admin-form-input" placeholder="https://...">
            </div>
            <div class="admin-form-group">
                <label class="admin-form-label">Category</label>
                <select name="category_id" id="research_entry_category" class="admin-form-select" required>
                    <option value="">Select category</option>
                    {% for cat in research_categories %}
                    <option value="{{ cat.id_str }}">{{ cat.name }}</option>
                    {% endfor %}
                </select>
            </div>
            <div style="display:flex; gap:0.75rem; margin-top:1.5rem;">
                <button type="button" onclick="closeResearchEntryModal()" class="admin-btn-secondary" style="flex:1; justify-content:center;">Cancel</button>
                <button type="submit" class="admin-btn-success" style="flex:1; justify-content:center;">Save</button>
            </div>
        </form>
    </div>
</div>

<!-- Research Delete Modals -->
<div id="researchCategoryDeleteModal" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.8); z-index:9999; align-items:center; justify-content:center;">
    <div class="admin-card" style="max-width:420px; margin:2rem;">
        <h3 style="font-weight:600; margin-bottom:1rem; color:var(--admin-text-primary);">Delete Research Category</h3>
        <p style="color:var(--admin-text-secondary); margin-bottom:1.5rem;">Delete "<span id="deleteResearchCategoryName"></span>"?</p>
        <div style="display:flex; gap:0.75rem;">
            <button type="button" onclick="closeResearchCategoryDeleteModal()" class="admin-btn-secondary" style="flex:1; justify-content:center;">Cancel</button>
            <form id="researchCategoryDeleteForm" method="POST" style="flex:1;">
                {% csrf_token %}
                <button type="submit" class="admin-btn-danger" style="width:100%; justify-content:center;">Delete</button>
            </form>
        </div>
    </div>
</div>
<div id="researchEntryDeleteModal" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.8); z-index:9999; align-items:center; justify-content:center;">
    <div class="admin-card" style="max-width:420px; margin:2rem;">
        <h3 style="font-weight:600; margin-bottom:1rem; color:var(--admin-text-primary);">Delete Research Entry</h3>
        <p style="color:var(--admin-text-secondary); margin-bottom:1.5rem;">Delete "<span id="deleteResearchEntryName"></span>"?</p>
        <div style="display:flex; gap:0.75rem;">
            <button type="button" onclick="closeResearchEntryDeleteModal()" class="admin-btn-secondary" style="flex:1; justify-content:center;">Cancel</button>
            <form id="researchEntryDeleteForm" method="POST" style="flex:1;">
                {% csrf_token %}
                <button type="submit" class="admin-btn-danger" style="width:100%; justify-content:center;">Delete</button>
            </form>
        </div>
    </div>
</div>

<!-- Delete Modals -->
<div id="deleteModal" style="display: none; position: fixed; inset: 0; background: rgba(0, 0, 0, 0.8); z-index: 9999; align-items: center; justify-content: center;">
    <div class="admin-card" style="max-width: 400px; margin: 2rem;">
        <h3 style="font-weight: 600; margin-bottom: 1rem; color: var(--admin-text-primary);">
            Confirm Delete
        </h3>
        <p style="color: var(--admin-text-secondary); margin-bottom: 1.5rem;">
            Are you sure you want to delete "<span id="deleteItemName"></span>"?
        </p>
        <div style="display: flex; gap: 0.75rem;">
            <button onclick="closeDeleteModal()" class="admin-btn-secondary" style="flex: 1; justify-content: center;">
                Cancel
            </button>
            <form id="deleteForm" method="POST" style="flex: 1;">
                {% csrf_token %}
                <button type="submit" class="admin-btn-danger" style="width: 100%; justify-content: center;">
                    Delete
                </button>
            </form>
        </div>
    </div>
</div>

{% endblock %}

{% block extra_js %}
<script>
    // Initialize Quill Editor
    var quillIntro = new Quill('#quill-introduction', {
        theme: 'snow',
        modules: {
            toolbar: [
                [{ 'header': [2, 3, false] }],
                ['bold', 'italic', 'underline'],
                [{ 'list': 'ordered'}, { 'list': 'bullet' }],
                ['link'],
                ['clean']
            ]
        },
        placeholder: 'Write your introduction...'
    });
    
    // Form submission
    document.getElementById('aboutPageForm').addEventListener('submit', function(e) {
        document.getElementById('introduction').value = quillIntro.root.innerHTML;
    });
    
    // Education Modal Functions
    function openEducationModal() {
        document.getElementById('educationModalTitle').textContent = 'Add Education Entry';
        document.getElementById('educationForm').reset();
        document.getElementById('educationForm').action = '{% url "admin_education_create" %}';
        document.getElementById('educationModal').style.display = 'flex';
    }
    
    function editEducation(id, degree, institution, year, description, order) {
        document.getElementById('educationModalTitle').textContent = 'Edit Education Entry';
        document.getElementById('edu_degree').value = degree;
        document.getElementById('edu_institution').value = institution;
        document.getElementById('edu_year').value = year;
        document.getElementById('edu_description').value = description;
        document.getElementById('edu_order').value = order;
        document.getElementById('educationForm').action = `/admin/pages/about/education/${id}/edit/`;
        document.getElementById('educationModal').style.display = 'flex';
    }
    
    function closeEducationModal() {
        document.getElementById('educationModal').style.display = 'none';
    }
    
    function deleteEducation(id, name) {
        document.getElementById('deleteItemName').textContent = name;
        document.getElementById('deleteForm').action = `/admin/pages/about/education/${id}/delete/`;
        document.getElementById('deleteModal').style.display = 'flex';
    }
    
    // Interest Modal Functions
    function openInterestModal() {
        document.getElementById('interestModalTitle').textContent = 'Add Interest';
        document.getElementById('interestForm').reset();
        document.getElementById('interestForm').action = '{% url "admin_interest_create" %}';
        document.getElementById('interestModal').style.display = 'flex';
    }
    
    function editInterest(id, title, description, icon, color, order) {
        document.getElementById('interestModalTitle').textContent = 'Edit Interest';
        document.getElementById('int_title').value = title;
        document.getElementById('int_description').value = description;
        document.getElementById('int_icon').value = icon;
        document.getElementById('int_color').value = color;
        document.getElementById('int_order').value = order;
        document.getElementById('interestForm').action = `/admin/pages/about/interests/${id}/edit/`;
        document.getElementById('interestModal').style.display = 'flex';
    }
    
    function closeInterestModal() {
        document.getElementById('interestModal').style.display = 'none';
    }
    
    function deleteInterest(id, name) {
        document.getElementById('deleteItemName').textContent = name;
        document.getElementById('deleteForm').action = `/admin/pages/about/interests/${id}/delete/`;
        document.getElementById('deleteModal').style.display = 'flex';
    }
    
    // Value Modal Functions
    function openValueModal() {
        document.getElementById('valueModalTitle').textContent = 'Add Core Value';
        document.getElementById('valueForm').reset();
        document.getElementById('valueForm').action = '{% url "admin_value_create" %}';
        document.getElementById('valueModal').style.display = 'flex';
    }
    
    function editValue(id, title, description, icon, color, order) {
        document.getElementById('valueModalTitle').textContent = 'Edit Core Value';
        document.getElementById('val_title').value = title;
        document.getElementById('val_description').value = description;
        document.getElementById('val_icon').value = icon;
        document.getElementById('val_color').value = color;
        document.getElementById('val_order').value = order;
        document.getElementById('valueForm').action = `/admin/pages/about/values/${id}/edit/`;
        document.getElementById('valueModal').style.display = 'flex';
    }
    
    function closeValueModal() {
        document.getElementById('valueModal').style.display = 'none';
    }
    
    function openExperienceModal(mode, id='', title='', organization='', period='', description='', order=0, isActive='true') {
        document.getElementById('experienceForm').reset();
        document.getElementById('experienceModalTitle').textContent = mode === 'edit' ? 'Edit Experience Entry' : 'Add Experience Entry';
        document.getElementById('experience_id').value = mode === 'edit' ? id : '';
        document.getElementById('exp_title').value = title;
        document.getElementById('exp_organization').value = organization;
        document.getElementById('exp_period').value = period;
        document.getElementById('exp_description').value = description;
        document.getElementById('exp_order').value = order;
        document.getElementById('exp_active').checked = String(isActive) === 'true';
        document.getElementById('experienceForm').action = mode === 'edit' ? `/admin/pages/about/experiences/${id}/edit/` : '{% url "admin_experience_create" %}';
        document.getElementById('experienceModal').style.display = 'flex';
    }

    function editExperience(id, title, organization, period, description, order, isActive) {
        openExperienceModal('edit', id, title, organization, period, description, order, isActive);
    }

    function closeExperienceModal() {
        document.getElementById('experienceForm').reset();
        document.getElementById('experience_id').value = '';
        document.getElementById('experienceModal').style.display = 'none';
    }

    function deleteExperience(id, name) {
        document.getElementById('deleteItemName').textContent = name;
        document.getElementById('deleteForm').action = `/admin/pages/about/experiences/${id}/delete/`;
        document.getElementById('deleteModal').style.display = 'flex';
    }

    function openAchievementModal(mode, id='', title='', description='', year='', link='', order=0, isActive='true') {
        document.getElementById('achievementForm').reset();
        document.getElementById('achievementModalTitle').textContent = mode === 'edit' ? 'Edit Achievement Entry' : 'Add Achievement Entry';
        document.getElementById('achievement_id').value = mode === 'edit' ? id : '';
        document.getElementById('ach_title').value = title;
        document.getElementById('ach_description').value = description;
        document.getElementById('ach_year').value = year;
        document.getElementById('ach_link').value = link;
        document.getElementById('ach_order').value = order;
        document.getElementById('ach_active').checked = String(isActive) === 'true';
        document.getElementById('achievementForm').action = mode === 'edit' ? `/admin/pages/about/achievements/${id}/edit/` : '{% url "admin_achievement_create" %}';
        document.getElementById('achievementModal').style.display = 'flex';
    }

    function editAchievement(id, title, description, year, link, order, isActive) {
        openAchievementModal('edit', id, title, description, year, link, order, isActive);
    }

    function closeAchievementModal() {
        document.getElementById('achievementForm').reset();
        document.getElementById('achievement_id').value = '';
        document.getElementById('achievementModal').style.display = 'none';
    }

    function deleteAchievement(id, name) {
        document.getElementById('deleteItemName').textContent = name;
        document.getElementById('deleteForm').action = `/admin/pages/about/achievements/${id}/delete/`;
        document.getElementById('deleteModal').style.display = 'flex';
    }

    function deleteValue(id, name) {
        document.getElementById('deleteItemName').textContent = name;
        document.getElementById('deleteForm').action = `/admin/pages/about/values/${id}/delete/`;
        document.getElementById('deleteModal').style.display = 'flex';
    }
    
    function closeDeleteModal() {
        document.getElementById('deleteModal').style.display = 'none';
    }

    function openResearchCategoryModal(mode, id='', name='', description='', order=0, isActive='true') {
        document.getElementById('researchCategoryModalTitle').textContent = mode === 'edit' ? 'Edit Research Category' : 'Add Research Category';
        document.getElementById('research_category_id').value = mode === 'edit' ? id : '';
        document.getElementById('research_category_name').value = name;
        document.getElementById('research_category_description').value = description;
        document.getElementById('research_category_order').value = order;
        document.getElementById('research_category_active').checked = String(isActive) === 'true';
        document.getElementById('researchCategoryForm').action = mode === 'edit' ? `/admin/pages/about/research-categories/${id}/edit/` : '{% url "admin_research_category_create" %}';
        document.getElementById('researchCategoryModal').style.display = 'flex';
    }

    function closeResearchCategoryModal() {
        document.getElementById('researchCategoryForm').reset();
        document.getElementById('research_category_id').value = '';
        document.getElementById('researchCategoryModal').style.display = 'none';
    }

    function confirmResearchCategoryDelete(id, name) {
        document.getElementById('deleteResearchCategoryName').textContent = name;
        document.getElementById('researchCategoryDeleteForm').action = `/admin/pages/about/research-categories/${id}/delete/`;
        document.getElementById('researchCategoryDeleteModal').style.display = 'flex';
    }

    function closeResearchCategoryDeleteModal() {
        document.getElementById('researchCategoryDeleteModal').style.display = 'none';
    }

    function openResearchEntryModal(mode, id='', title='', description='', publication='', link='', category='') {
        document.getElementById('researchEntryModalTitle').textContent = mode === 'edit' ? 'Edit Research Entry' : 'Add Research Entry';
        document.getElementById('research_entry_id').value = mode === 'edit' ? id : '';
        document.getElementById('research_entry_title').value = title;
        document.getElementById('research_entry_description').value = description;
        document.getElementById('research_entry_publication').value = publication;
        document.getElementById('research_entry_link').value = link;
        document.getElementById('research_entry_category').value = category || '';
        document.getElementById('researchEntryForm').action = mode === 'edit' ? `/admin/pages/about/research-entries/${id}/edit/` : '{% url "admin_research_entry_create" %}';
        document.getElementById('researchEntryModal').style.display = 'flex';
    }

    function closeResearchEntryModal() {
        document.getElementById('researchEntryForm').reset();
        document.getElementById('research_entry_id').value = '';
        document.getElementById('researchEntryModal').style.display = 'none';
    }

    function editResearchEntry(id, title, description, publication, link, category) {
        openResearchEntryModal('edit', id, title, description, publication, link, category);
    }

    function confirmResearchEntryDelete(id, name) {
        document.getElementById('deleteResearchEntryName').textContent = name;
        document.getElementById('researchEntryDeleteForm').action = `/admin/pages/about/research-entries/${id}/delete/`;
        document.getElementById('researchEntryDeleteModal').style.display = 'flex';
    }

                function closeResearchEntryDeleteModal() {
                    document.getElementById('researchEntryDeleteModal').style.display = 'none';
                }

                const researchEntriesSection = document.getElementById('research-entries-section');

                async function handleResearchFilterSubmit(event) {
                    event.preventDefault();
                    const form = event.currentTarget;
                    const params = new URLSearchParams(new FormData(form));
                    const url = `${window.location.pathname}?${params.toString()}`;
                    try {
                        const response = await fetch(url, {
                            headers: {
                                'X-Requested-With': 'XMLHttpRequest'
                            }
                        });
                        if (!response.ok) {
                            throw new Error('Unable to load research entries.');
                        }
                        const text = await response.text();
                        const parser = new DOMParser();
                        const doc = parser.parseFromString(text, 'text/html');
                        const newSection = doc.getElementById('research-entries-section');
                        if (newSection && researchEntriesSection) {
                            researchEntriesSection.innerHTML = newSection.innerHTML;
                            attachResearchFilterHandler();
                        }
                        window.history.replaceState(null, '', url);
                    } catch (error) {
                        console.error(error);
                    }
                }

                function attachResearchFilterHandler() {
                    const form = document.getElementById('researchFilterForm');
                    if (!form || form.dataset.researchListenerAttached === 'true') {
                        return;
                    }
                    form.dataset.researchListenerAttached = 'true';
                    form.addEventListener('submit', handleResearchFilterSubmit);
                }

                attachResearchFilterHandler();
            </script>
{% endblock %}
