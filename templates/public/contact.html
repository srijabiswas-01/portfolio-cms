{% extends 'public/base.html' %}

{% block title %}Contact - Portfolio{% endblock %}

{% block content %}
<!-- Contact Hero -->
<section class="py-20">
    <div class="container mx-auto px-4">
        {% if contact_page_visibility.page_header %}
        <div class="text-center mb-16">
            {% if contact_page_visibility.page_title %}
            <h1 class="text-5xl font-bold font-poppins mb-4">
                {{ contact_page.page_title|default:"Get In " }}<span class="text-accent-primary">Touch</span>
            </h1>
            {% endif %}
            <div class="w-20 h-1 bg-accent-primary rounded-full mx-auto mb-6"></div>
            {% if contact_page_visibility.page_subtitle %}
            <p class="text-xl text-secondary max-w-2xl mx-auto">
                {{ contact_page.page_subtitle|default:"Have a project in mind or want to collaborate? I'd love to hear from you!" }}
            </p>
            {% endif %}
        </div>
        {% endif %}

        <div class="grid lg:grid-cols-2 gap-12 max-w-6xl mx-auto">
            <!-- Contact Information -->
            <div>
            {% if contact_page_visibility.connect_section %}
            <div class="mb-12">
                <h2 class="text-3xl font-bold font-poppins mb-6">{{ contact_page.connect_title|default:"Let's Connect" }}</h2>
                <div class="text-secondary text-lg leading-relaxed space-y-4">
                    {{ contact_page.connect_description|default:"Whether you have a question, want to discuss a project, or just want to say hello, feel free to reach out. I'm always open to new opportunities and collaborations."|safe }}
                </div>
            </div>
            {% endif %}

                <!-- Contact Cards -->
                {% if contact_page_visibility.contact_info %}
                <div class="space-y-6">
                    <!-- Email -->
                    <div class="bg-card border border-color rounded-xl p-6 hover:border-accent-primary transition-all group">
                        <div class="flex items-start gap-4">
                            <div class="w-14 h-14 bg-accent-primary/20 rounded-lg flex items-center justify-center flex-shrink-0 group-hover:bg-accent-primary/30 transition-colors">
                                <i class="bi bi-envelope text-2xl text-accent-primary"></i>
                            </div>
                            <div>
                                <h3 class="font-semibold text-lg mb-1">Email</h3>
                                <p class="text-muted text-sm mb-2">Send me an email</p>
                                <a href="mailto:{{ profile.email }}" class="text-accent-primary hover:text-accent-secondary transition-colors">
                                    {{ profile.email|default:"your.email@example.com" }}
                                </a>
                            </div>
                        </div>
                    </div>

                    <!-- Phone -->
                    {% if profile.phone %}
                    <div class="bg-card border border-color rounded-xl p-6 hover:border-accent-primary transition-all group">
                        <div class="flex items-start gap-4">
                            <div class="w-14 h-14 bg-accent-secondary/20 rounded-lg flex items-center justify-center flex-shrink-0 group-hover:bg-accent-secondary/30 transition-colors">
                                <i class="bi bi-telephone text-2xl text-accent-secondary"></i>
                            </div>
                            <div>
                                <h3 class="font-semibold text-lg mb-1">Phone</h3>
                                <p class="text-muted text-sm mb-2">Give me a call</p>
                                <a href="tel:{{ profile.phone }}" class="text-accent-primary hover:text-accent-secondary transition-colors">
                                    {{ profile.phone }}
                                </a>
                            </div>
                        </div>
                    </div>
                    {% endif %}

                    <!-- Location -->
                    <div class="bg-card border border-color rounded-xl p-6 hover:border-accent-primary transition-all group">
                        <div class="flex items-start gap-4">
                            <div class="w-14 h-14 bg-accent-success/20 rounded-lg flex items-center justify-center flex-shrink-0 group-hover:bg-accent-success/30 transition-colors">
                                <i class="bi bi-geo-alt text-2xl text-accent-success"></i>
                            </div>
                            <div>
                                <h3 class="font-semibold text-lg mb-1">Location</h3>
                                <p class="text-muted text-sm mb-2">Based in</p>
                                <p class="text-secondary">India</p>
                            </div>
                        </div>
                    </div>
                </div>
                {% endif %}

                <!-- Social Links -->
                <div class="mt-12">
                    <h3 class="font-semibold text-lg mb-4">Follow Me</h3>
                    <div class="flex gap-4">
                        {% if profile.github %}
                        <a href="{{ profile.github }}" target="_blank" class="social-icon">
                            <i class="bi bi-github"></i>
                        </a>
                        {% endif %}
                        {% if profile.linkedin %}
                        <a href="{{ profile.linkedin }}" target="_blank" class="social-icon">
                            <i class="bi bi-linkedin"></i>
                        </a>
                        {% endif %}
                        {% if profile.twitter %}
                        <a href="{{ profile.twitter }}" target="_blank" class="social-icon">
                            <i class="bi bi-twitter"></i>
                        </a>
                        {% endif %}
                        <a href="mailto:{{ profile.email }}" class="social-icon">
                            <i class="bi bi-envelope"></i>
                        </a>
                    </div>
                </div>
            </div>

            {% comment %} <!-- Contact Form -->
            <div class="bg-card border border-color rounded-2xl p-8">
                <h2 class="text-2xl font-bold font-poppins mb-6">Send a Message</h2>
                
                <form id="contactForm" class="space-y-6">
                    <!-- Name -->
                    <div>
                        <label for="name" class="block text-sm font-medium mb-2">Your Name *</label>
                        <input type="text" 
                               id="name" 
                               name="name" 
                               required
                               class="w-full bg-secondary border border-color rounded-lg px-4 py-3 text-primary placeholder-muted focus:outline-none focus:border-accent-primary transition-all"
                               placeholder="John Doe">
                    </div>

                    <!-- Email -->
                    <div>
                        <label for="email" class="block text-sm font-medium mb-2">Your Email *</label>
                        <input type="email" 
                               id="email" 
                               name="email" 
                               required
                               class="w-full bg-secondary border border-color rounded-lg px-4 py-3 text-primary placeholder-muted focus:outline-none focus:border-accent-primary transition-all"
                               placeholder="john@example.com">
                    </div>

                    <!-- Subject -->
                    <div>
                        <label for="subject" class="block text-sm font-medium mb-2">Subject *</label>
                        <input type="text" 
                               id="subject" 
                               name="subject" 
                               required
                               class="w-full bg-secondary border border-color rounded-lg px-4 py-3 text-primary placeholder-muted focus:outline-none focus:border-accent-primary transition-all"
                               placeholder="Project Inquiry">
                    </div>

                    <!-- Message -->
                    <div>
                        <label for="message" class="block text-sm font-medium mb-2">Message *</label>
                        <textarea id="message" 
                                  name="message" 
                                  required
                                  rows="5"
                                  class="w-full bg-secondary border border-color rounded-lg px-4 py-3 text-primary placeholder-muted focus:outline-none focus:border-accent-primary transition-all resize-none"
                                  placeholder="Tell me about your project..."></textarea>
                    </div>

                    <!-- Submit Button -->
                    <button type="submit" class="btn-primary w-full justify-center">
                        <i class="bi bi-send mr-2"></i>
                        Send Message
                    </button>
                </form>

                <p class="text-sm text-muted mt-6 text-center">
                    I'll get back to you as soon as possible!
                </p>
            </div>
        </div> {% endcomment %}
<!-- Contact Form -->
{% if contact_page_visibility.contact_form %}
<div class="bg-card border border-color rounded-2xl p-8">
    <h2 class="text-2xl font-bold font-poppins mb-6">Send a Message</h2>
    
    <form id="contactForm" method="POST" class="space-y-6">
        {% csrf_token %}
        
        <!-- Success Message (Hidden by default) -->
        <div id="successMessage" style="display: none;" class="bg-green-500/10 border border-green-500/30 text-green-400 rounded-lg p-4 mb-4">
            <i class="bi bi-check-circle-fill mr-2"></i>
            <span>Thank you! Your message has been sent successfully.</span>
        </div>
        
        <!-- Error Message (Hidden by default) -->
        <div id="errorMessage" style="display: none;" class="bg-red-500/10 border border-red-500/30 text-red-400 rounded-lg p-4 mb-4">
            <i class="bi bi-x-circle-fill mr-2"></i>
            <span>Please fill in all required fields.</span>
        </div>
        
        <!-- Name -->
        <div>
            <label for="name" class="block text-sm font-medium mb-2">Your Name *</label>
            <input type="text" 
                   id="name" 
                   name="name" 
                   required
                   class="w-full bg-secondary border border-color rounded-lg px-4 py-3 text-primary placeholder-muted focus:outline-none focus:border-accent-primary transition-all"
                   placeholder="John Doe">
        </div>

        <!-- Email -->
        <div>
            <label for="email" class="block text-sm font-medium mb-2">Your Email *</label>
            <input type="email" 
                   id="email" 
                   name="email" 
                   required
                   class="w-full bg-secondary border border-color rounded-lg px-4 py-3 text-primary placeholder-muted focus:outline-none focus:border-accent-primary transition-all"
                   placeholder="john@example.com">
        </div>

        <!-- Subject -->
        <div>
            <label for="subject" class="block text-sm font-medium mb-2">Subject *</label>
            <input type="text" 
                   id="subject" 
                   name="subject" 
                   required
                   class="w-full bg-secondary border border-color rounded-lg px-4 py-3 text-primary placeholder-muted focus:outline-none focus:border-accent-primary transition-all"
                   placeholder="Project Inquiry">
        </div>

        <!-- Message -->
        <div>
            <label for="message" class="block text-sm font-medium mb-2">Message *</label>
            <textarea id="message" 
                      name="message" 
                      required
                      rows="5"
                      class="w-full bg-secondary border border-color rounded-lg px-4 py-3 text-primary placeholder-muted focus:outline-none focus:border-accent-primary transition-all resize-none"
                      placeholder="Tell me about your project..."></textarea>
        </div>

        <!-- Submit Button -->
        <button type="submit" class="btn-primary w-full justify-center" id="submitBtn">
            <i class="bi bi-send mr-2"></i>
            <span id="btnText">Send Message</span>
        </button>
    </form>

    <p class="text-sm text-muted mt-6 text-center">
        I'll get back to you as soon as possible!
    </p>
    </div>
{% endif %}


        <!-- CTA Section -->
        {% if contact_page_visibility.cta_section %}
        <div class="mt-20 bg-gradient-to-r from-accent-primary to-accent-secondary rounded-2xl p-12 text-center">
            <h2 class="text-3xl font-bold font-poppins mb-4">{{ contact_page.cta_title|default:"Ready to Start a Project?" }}</h2>
            <p class="text-lg mb-8 opacity-90 max-w-2xl mx-auto">
                {{ contact_page.cta_description|default:"Let's work together to bring your ideas to life. I'm always excited to take on new challenges." }}
            </p>
            <a href="{% url 'projects' %}" class="inline-block bg-white text-accent-primary px-8 py-3 rounded-lg font-semibold hover:shadow-lg transition">
                {{ contact_page.cta_button_text|default:"View My Work" }}
                <i class="bi bi-arrow-right ml-2"></i>
            </a>
        </div>
        {% endif %}
    </div>
</section>

{% comment %} <script>
    document.getElementById('contactForm').addEventListener('submit', function(e) {
        e.preventDefault();
        
        // Get form data
        const formData = new FormData(this);
        const name = formData.get('name');
        const email = formData.get('email');
        const subject = formData.get('subject');
        const message = formData.get('message');
        
        // Create mailto link
        const mailtoLink = `mailto:{{ profile.email|default:"your.email@example.com" }}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(`From: ${name} (${email})\n\n${message}`)}`;
        
        // Open mailto link
        window.location.href = mailtoLink;
        
        // Show success message
        alert('Opening your email client...');
        
        // Reset form
        this.reset();
    });
</script> {% endcomment %}
<script>
    document.getElementById('contactForm').addEventListener('submit', function(e) {
        e.preventDefault();
        
        const form = this;
        const submitBtn = document.getElementById('submitBtn');
        const btnText = document.getElementById('btnText');
        const successMsg = document.getElementById('successMessage');
        const errorMsg = document.getElementById('errorMessage');
        
        // Hide previous messages
        successMsg.style.display = 'none';
        errorMsg.style.display = 'none';
        
        // Disable button and show loading
        submitBtn.disabled = true;
        btnText.textContent = 'Sending...';
        
        // Create FormData
        const formData = new FormData(form);
        
        // Send AJAX request
        fetch('{% url "contact" %}', {
            method: 'POST',
            body: formData,
            headers: {
                'X-Requested-With': 'XMLHttpRequest',
                'X-CSRFToken': formData.get('csrfmiddlewaretoken')
            }
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                // Show success message
                successMsg.style.display = 'block';
                // Reset form
                form.reset();
                // Scroll to message
                successMsg.scrollIntoView({ behavior: 'smooth', block: 'center' });
            } else {
                // Show error message
                errorMsg.querySelector('span').textContent = data.message || 'Please fill in all required fields.';
                errorMsg.style.display = 'block';
                errorMsg.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
        })
        .catch(error => {
            console.error('Error:', error);
            errorMsg.querySelector('span').textContent = 'An error occurred. Please try again.';
            errorMsg.style.display = 'block';
        })
        .finally(() => {
            // Re-enable button
            submitBtn.disabled = false;
            btnText.textContent = 'Send Message';
        });
    });
</script>
{% endblock %}
